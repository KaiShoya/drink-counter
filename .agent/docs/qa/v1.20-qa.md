# ❓ QA リスト v1.20

**最終更新**: 2025-12-13  
**バージョン**: 1.20.x  
**ステータス**: Active  
**テーマ**: UX対応 + メイン機能補強に関する Q&A  
**関連**: qa-index.md, agent-documentation-workflow.md

---

## 実装予定の機能に関する Q&A

### [UI/UX] Issue #291: ダークモード対応の実装

**Question**: テーマ切り替えはどのタイミングで自動適用する？OS 設定 or ユーザー明示的選択？

**Answer**: 初回は OS の `prefers-color-scheme` を採用。ユーザーが明示的にテーマを選択した後は、その選択（light/dark）を優先しストレージに保持（再訪時も継続）。システム追従オプションは提供せず、シンプルな light/dark 切り替えのみ。

**Decided on**: 2025-12-13 (updated 2025-12-13)

**優先度**: 中  
**関連**: #291

---

### [UI/UX] Issue #292: オフラインサポート実装時の同期戦略

**Question**: オフラインで記録したデータを再接続時に自動同期？ユーザー確認後？

**Answer**: 未決定 → Issue #292 のコメントで決定予定

**優先度**: 中  
**影響範囲**: データ一貫性

---

## 汎用的な設計決定（v1.20 以降で適用）

### [アーキテクチャ] グローバルストアと data ストアの責務分離

**Question**: Data Store で複数のリポジトリを呼び出す場合、Page Store か Data Store どちらで集約すべきか？

**Answer**: Data Store では単一のリポジトリのみを呼び出し、集約は Page Store で実施する。Data Store は「データベーステーブルをミラーリング」することに集中。

**Decided on**: 2025-12-10  
**Related**: state-management.md

---

### [アーキテクチャ] ローカル composable vs Pinia ストア

**Question**: ローカルな一時状態（フォーム入力、UI トグル）は `ref` で管理すべき？Pinia？

**Answer**: 
- **ページ状態**: Pinia で管理（page store）
- **コンポーネント状態**: 基本は `ref` で管理。複雑な状態管理が必要な場合のみ Pinia を使用

**Decided on**: 2025-12-10  
**Related**: architecture.md「各層の責務」参照

**Examples**:
- ✅ ページ全体の状態（フォームデータ、ローディング、エラー）→ Pinia (page store)
- ✅ コンポーネント内の UI トグル（モーダル表示/非表示）→ `ref`
- ⚠️ 複雑なコンポーネント（複数子要素の状態同期が必要）→ Pinia (store で composable化)

---

### [UI/UX] ローディング UI の UX

**Question**: グローバルなローディング表示 vs アクション毎のローディング？

**Answer**: グローバル `isLoading` 状態で一元管理（現在の実装）。ただし、大規模データ操作では詳細なプログレス表示を検討。

**Decided on**: 2025-12-10  
**Related**: state-management.md / features.md

---

## Notes

- GitHub Issues とこのファイルは連携・同期させる
- 決定済み Q&A は `.agent/specs/` に統合する
- 3ヶ月ごとに見直し・整理
